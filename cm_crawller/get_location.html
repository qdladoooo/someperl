<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=C504510078f1ac6706894b947f06796b"></script>
    <script type="text/javascript" src="http://lib.sinaapp.com/js/jquery/2.0.3/jquery-2.0.3.min.js"></script>
    <title>地址解析</title>
</head>
<body>
    <div id="allmap"></div>
    <textarea id="r_box" style="position: absolute; left: 0; top: 0; width: 400px; height: 400px;background-color: #fff;z-index: 10000;overflow: scroll;">

    </textarea>    
</body>
</html>
<script type="text/javascript">
    // 百度地图API功能
    var map = new BMap.Map("allmap");
    var point = new BMap.Point(116.331398,39.897445);
    map.centerAndZoom(point,12);
    // 创建地址解析器实例
    var myGeo = new BMap.Geocoder();
    
    var cm_ar = ["盛世年华", "梅园五街坊"];

    // for(var i in cm_ar) {
    //     var cm_name = cm_ar[i];
    //     var str = "";

    //     console.log(i + "    " + cm_name);
    //     //getP(cm_name);
    // }
    
    var i = 0;
    var str = '';
    getP(cm_ar, i);

    function getP(cm_ar, i) {
        if(i > 2) {
        // if(i > 2451) {
            return ;
        } else {
            var cm_name = cm_ar[i];
            console.log(i + "    " + cm_name);

            myGeo.getPoint(cm_name, function(point){
                if (point) {
                    str += i + '####' + cm_name + '####Success####' + point.lng + '####' + point.lat + "\r\n";

                    map.centerAndZoom(point, 16);
                    map.addOverlay(new BMap.Marker(point));
                } else {
                    str += i + '####' + cm_name + '####Failure####' + "\r\n";
                }
                $('#r_box').text( str );

                setTimeout( getP(cm_ar, ++i) );
            }, "上海市");
        }
    }

</script>
